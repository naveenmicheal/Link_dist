{%include 'layout.html'%}
{%block content%}
<!-- Navigation -->
<!-- JSON -->

 <nav class="indigo darken-4">
    <div class="nav-wrapper">
      <a href="#!" style="font-family: 'Bree Serif', serif;" class="brand-logo">Link Exposer</a>
      <a href="#" data-target="mobile_nav" class="sidenav-trigger"><i class="material-icons">menu</i></a>
      <ul class="right  hide-on-med-and-down">
        <li><a href="#">About</a></li>
        <li><a href="#">Contact</a></li>
        <li><a href="#">Donate</a></li>
        <!-- <li><a href="#"></a></li> -->
      </ul>
    </div>
  </nav>

  <ul class="sidenav" id="mobile_nav">
    <li><a href="#">Navigation</a></li>
    <li><a href="#">Navigation</a></li>
    <li><a href="#">Navigation</a></li>
    <li><a href="#">Navigation</a></li>
  </ul>
<!-- Navigation End -->

<!-- Sectiobn -->
<div class="box center-align">
	<div class="heading">
		<h1 id="headtitle" style="font-family: 'Bree Serif'">Distination Exposer</h1>
    {%if msg%}
		<p style="color: #ff4d4d">{{msg}}</p>
    {%else%}
    <p>Enter the URL</p>
    {%endif%}

	</div>
  
  <form method="POST", action="{{url_for('home')}}"> 
	<div class="input ">
		<div class="row">
		<div class="input-field col s12">
          <input name='url' class="center-align" id="last_name" type="url" required class="validate">
          <label id="label" for="last_name">URL </label>
        </div>
        </div>
	</div>
  <button class="btn waves-effect waves-light purple"  type="submit">Submit
             <i class="material-icons right">send</i>
     </button>
</div>
</form>
<style type="text/css">
   #result{
    margin-top: 20px;
    border: solid 1px black;
    background-color: #2c3e50;
    color: white;
    margin-right: 300px;
    margin-left: 300px;
  } 
#last_name{
  width: 40%;
}
label{
  margin-left: 30% !important;
}
/*For Input focus style*/
#last_name:focus{
  /*border: 1px solid black;*/
  border-radius: 5px;
  background-color: #2c3e50;
  color: white;
}

 
  #heading h6{
    margin-top: 0px;
    margin-bottom: 0px;
    background-color: #2980b9;
    color: white;
    padding: 10px;
  }
  .row{
    font-size: 16px;
  }
  .chk{
    padding: 10px;

  }
  
  .chk a{
    color: white;
    padding: 7px;
    border-radius: 3px;
    background-color: #9b59b6;
  }
   @media only screen and (max-width: 600px) {
   #result{
    margin-right: 5px;
    margin-left: 5px;
   }
   h1{
    font-size: 40px;

   }
  input{
    width: 80% !important;
   }
   label{
  margin-left: 10% !important;
  }
   #destination{
    word-wrap: anywhere !important; 
   }
    .chk{
    padding: 1px;

  }
  .chk a{
    color: white;
    padding: 2px;
    border-radius: 3px;
    background-color: #9b59b6;
  }
}

</style>

{%if d_url%}
<div id="result" class='center-align'>
  <div id="heading">
      <h6>Link Information</h6>
  </div>
 <!--  <div id="sub">
    <p><span class='row'>Distination:</span> Testing.com</p>
    <p><span class='row'>Title:</span>That is a Example</p>
    <p><span class='row'>Google SafeBrowsing:</span>
      <a href="#">https://googlel/fkdpfkkfekf</a></p>
    <p><span class='row'> Web Of trust:</span><a href="#">
      https:/dsfdsfjdsfjodsjfjdsfjoj
    </a></p>
  </div> -->
  
  <table>

        <tbody>
          <tr>
            <td><b>Destination</b></td>
            <td id="destination">{{d_url}}</td>
           <!--  <td>Title</td>
            <td>hof</td> -->
          </tr>
          <tr>
            <td><b>Redirection</b></td>
            <td id="count"> {{count}}
              <div style="display: none" id="path">
              <ol>
                {%for count in range(count) %}
                  <p style=" word-wrap: anywhere !important; "> {{r_url[count]}}</p>

              {%endfor%}
              </ol>
              </div>
               <button id="showbtn" style="margin-left: 10px" class=" btn-small blue" onclick="show()">View Redircts</button> 
               <button id="closebtn" style="margin-left: 10px;display: none; " class=" red btn-small"
                onclick="closepage()">
                 Close Redirects
               </button>
            </td>
           <script type="text/javascript">
             var a = document.getElementById('count').innerText;
             if(a =="0 VIEW REDIRCTS"){
              console.log("NO Redirection");
              document.getElementById('count').innerHTML = "<td>No Redirection</td>";
             }
             function show(){
             var path = document.getElementById('path');
             path.style.display ='block';
             var showbtn = document.getElementById('showbtn');
             showbtn.style.display='none';
             var close = document.getElementById('closebtn');
             close.style.display ='block';

           }

           function closepage(){
            console.log('Close fun')
            var path = document.getElementById('path');
            showbtn.style.display='inline';
            path.style.display ='none';
            var close = document.getElementById('closebtn');
            close.style.display ='none';
            
           }
           
           </script>
          </tr>
          <tr>
            <td><b>Title</b></td>
            <td>{{title}}</td>
            <!-- <td>Jellybean</td>
            <td>$3.76</td> -->
          </tr>
          <tr>
            <td><b>Check URL on</b>
            </td>

             <td >
              <span class="chk"><a href="{{google_url}}" target="_blank">Google Safe</a></span>
              <span class="chk"><a href="{{nortan}}" target="_blank">Nortan</a></span>
              <span class="chk"><a href="{{wot}}" target="_blank">Web of trust</a></span>
             <!--  <span class="chk"><a href="#">Whois</a></span>
              <span class="chk"><a href="#">Virustotal</a></span> -->

            </td>
          </tr>
             <!-- <td class="center-align"><a href="#">Web Of Trust</a>
            </td>
             <td class="center-align"><a href="#">Nortan URL scan</a> -->
              <td><b>More on</b></td>
             <td>
              <span class="chk"><a href="https://www.virustotal.com/gui/home/url" target="_blank">Virus - Total</a></span>
              <span class="chk"><a href="https://whois.net/" target="_blank">Who-is</a></span>
              <span class="chk"><a href="https://sitecheck.sucuri.net/results/{{d_url}}" target="_blank">sucuri scanner</a></span>
            

            </td>
          </tr>
        </tbody>
      </table>
      {%endif%}  
</div>

<!-- MODELS -->
 <div id="modal1" class="modal">
    <div class="modal-content">
      <h4>Redirects Path</h4>
      {%if count%}
      {%for c in range(count)%}

      <p>{{r_url[c]}} <span style="margin-left: 7px; font-family:Courier New;"></span><b>Status Code: 301 </b></p>

      {%endfor%}
      <p>{{d_url}} <span style="margin-left: 7px;"><b>Status-code 200</b></span></p>
      {%endif%}

    </div>
    <div class="modal-footer">
      <a href="#!" class="modal-close waves-effect waves-green btn-flat">Agree</a>
    </div>
  </div>

  <br><br>
<!-- MODEL END -->
<style type="text/css">
body{
	background-color: #2f3640;
}

.sidenav{
	width: 250px !important;
}
#headtitle{
  color: white;
  text-shadow: 2px 2px #1B9CFC ;
}


</style>
<script type="text/javascript">
	 document.addEventListener('DOMContentLoaded', function() {
    var navbar = document.querySelectorAll('.sidenav');
    var instances = M.Sidenav.init(navbar, {});
  });

  
   // 
   
  


   //AJAX
  // function load() {
  // var i_url = new URL(document.URL)

  // var xhttp = new XMLHttpRequest();
  // xhttp.onreadystatechange = function() {
  //   if (this.readyState == 4 && this.status == 200) {
  //    document.getElementById("ans").innerHTML = this.responseText;
  //   }
  // };
  // xhttp.open("GET", "http://0.0.0.0:3333/url/httpbin.org", true);
  // xhttp.send();
//}
 // document.addEventListener('DOMContentLoaded', function() {
 //    var models = document.querySelectorAll('.modal');
 //    var instances = M.Modal.init(models, {});
 //  });
</script>
{%endblock content%} 